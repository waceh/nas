# Redis 추가 시 성능 분석

## 📊 현재 시스템 사양
- **OCPU**: 4 코어
- **RAM**: 24GB
- **디스크**: 47GB

## 📊 현재 시스템 구성

### 현재 실행 중인 서비스
1. **MySQL 8.4** - 관계형 데이터베이스
2. **Spring Boot Backend** (Java 25) - API 서버
3. **Kotlin Backend** (Java 25) - API 서버
4. **Vue.js Frontend** (Node.js 24.13.0) - 프론트엔드
5. **Portainer** - Docker 관리
6. **Netdata** - 실시간 모니터링

### 현재 리소스 사용량 추정

| 서비스 | RAM (예상) | CPU (예상) | 디스크 |
|--------|-----------|-----------|--------|
| MySQL 8.4 | 500MB - 1GB | 0.5-1 코어 | 5-10GB |
| Spring Boot | 300-500MB | 0.5 코어 | 1GB |
| Kotlin Backend | 300-500MB | 0.5 코어 | 1GB |
| Vue.js Frontend | 200-300MB | 0.3 코어 | 500MB |
| Portainer | 100-200MB | 0.2 코어 | 100MB |
| Netdata | 200-400MB | 0.3-0.5 코어 | 1-2GB |
| **현재 총합** | **2.2-3.9GB** | **3.0-3.9 코어** | **18-35GB** |

---

## 🔴 Redis 추가 시 리소스 요구사항

### Redis 최소 요구사항
- **RAM**: 최소 100MB, 권장 512MB-2GB (데이터량에 따라)
- **CPU**: 최소 0.1 코어, 권장 0.5 코어
- **디스크**: 최소 1GB, 권장 5-10GB (RDB/AOF 백업 파일)

### Redis 실제 사용량 (소규모 프로젝트)
- **RAM**: 100-500MB (기본 설정, 데이터에 따라 증가)
- **CPU**: 0.1-0.3 코어 (일반 작업)
- **디스크**: 1-5GB (RDB 스냅샷 + AOF 로그)

### Redis 추가 후 예상 리소스

| 항목 | 현재 | Redis 추가 후 | 증가량 |
|------|------|--------------|--------|
| **RAM** | 2.0-3.5GB | 2.1-4.0GB | +100MB~500MB |
| **CPU** | 2.7-3.4 코어 | 2.8-3.7 코어 | +0.1~0.3 코어 |
| **디스크** | 17-33GB | 18-38GB | +1~5GB |

---

## 📈 성능 영향 분석

### 1. 메모리 (RAM) 영향

#### Redis 추가 시
- **메모리 사용량**: 2.1-4.0GB / 24GB (약 9-17%)
- **여유 공간**: 20-21.9GB (약 83-91%)
- **평가**: ✅ RAM은 충분하며 Redis 추가 가능

#### Redis 메모리 최적화
- `maxmemory` 설정으로 메모리 제한 가능
- `maxmemory-policy` 설정으로 메모리 부족 시 정책 설정
- 권장: 512MB-1GB 제한 (소규모 프로젝트)

### 2. CPU 영향

#### Redis 추가 시
- **CPU 사용량**: 2.8-3.7 코어 / 4 코어 (약 70-93%)
- **여유 CPU**: 0.3-1.2 코어 (약 7-30%)
- **평가**: ✅ CPU는 충분하며 Redis 추가 가능

#### Redis CPU 특성
- 단일 스레드 기반 (CPU 코어 1개만 사용)
- CPU 사용량이 낮음 (0.1-0.3 코어)
- 현재 시스템에서 부담 없음

### 3. 디스크 I/O 영향

#### Redis 추가 시
- **디스크 사용량**: 18-38GB / 47GB (약 38-81%)
- **여유 공간**: 9-29GB (약 19-62%)
- **평가**: ✅ 디스크는 충분하며 Redis 추가 가능

#### Redis 디스크 사용
- RDB 스냅샷: 주기적 백업 파일
- AOF 로그: 영속성 로그 (선택사항)
- 디스크 사용량이 낮음 (1-5GB)

---

## 🎯 Redis 추가 시나리오

### 시나리오: Redis 추가 (권장) ⭐⭐⭐⭐⭐

**리소스 요구사항:**
- RAM: 2.1-4.0GB (현재 24GB 중 사용) ✅
- CPU: 2.8-3.7 코어 (현재 4 코어 중 사용) ✅
- 디스크: 18-38GB (현재 47GB 중 사용) ✅

**장점:**
- ✅ RAM 24GB로 충분 (20-21.9GB 여유)
- ✅ CPU 4 코어로 충분 (0.3-1.2 코어 여유)
- ✅ 디스크 47GB로 충분 (9-29GB 여유)
- ✅ 캐싱으로 애플리케이션 성능 향상
- ✅ 세션 저장소로 사용 가능
- ✅ 실시간 데이터 처리에 유용

**단점:**
- ⚠️ 메모리 기반이므로 데이터 손실 가능 (영속성 설정 필요)

**적합한 경우:**
- 캐싱으로 API 응답 속도 향상
- 세션 저장소 필요
- 실시간 데이터 처리
- 메시지 큐 (Pub/Sub)

---

## 💡 Redis 최적화 방안

### 1. 리소스 제한 설정

```yaml
redis:
  image: redis:7-alpine
  container_name: nas-redis
  restart: unless-stopped
  ports:
    - "6379:6379"
  volumes:
    - redis_data:/data
  command: >
    redis-server
    --maxmemory 512mb
    --maxmemory-policy allkeys-lru
    --appendonly yes
    --appendfsync everysec
  deploy:
    resources:
      limits:
        memory: 1G
        cpus: '0.5'
      reservations:
        memory: 256M
        cpus: '0.1'
  networks:
    - nas-network
```

### 2. Redis 설정 최적화

#### 메모리 관리
- `maxmemory 512mb`: 최대 메모리 제한
- `maxmemory-policy allkeys-lru`: 메모리 부족 시 LRU 정책

#### 영속성 설정
- `appendonly yes`: AOF 활성화 (데이터 영속성)
- `appendfsync everysec`: 1초마다 동기화 (성능과 안정성 균형)

### 3. 모니터링

- Netdata에서 Redis 메트릭 자동 수집 (Docker 컨테이너 자동 감지)
- 메모리 사용량 알림 설정

---

## 📊 결론

### 현재 시스템 (OCPU 4, RAM 24GB, 디스크 47GB)

| 구성 | RAM 사용 | RAM 여유 | CPU 사용 | CPU 여유 | 디스크 사용 | 디스크 여유 | 평가 |
|------|---------|---------|---------|---------|------------|------------|------|
| **현재** | 2-3.5GB | 20.5-22GB | 2.7-3.4 코어 | 0.6-1.3 코어 | 17-33GB | 14-30GB | ✅ 매우 여유 |
| **+ Redis** | 2.1-4.0GB | **20-21.9GB** | 2.8-3.7 코어 | **0.3-1.2 코어** | 18-38GB | **9-29GB** | ✅ **추가 가능** |

### 최종 권장사항

#### ✅ Redis 추가 권장
- **RAM**: 충분 (20-21.9GB 여유)
- **CPU**: 충분 (0.3-1.2 코어 여유)
- **디스크**: 충분 (9-29GB 여유)
- **성능 향상**: 캐싱으로 API 응답 속도 개선 예상

#### Redis 활용 방안
1. **캐싱**: 자주 조회하는 데이터 캐싱
2. **세션 저장소**: 분산 세션 관리
3. **실시간 데이터**: 실시간 카운터, 랭킹 등
4. **메시지 큐**: Pub/Sub 패턴 활용

#### 주의사항
- 메모리 제한 설정 권장 (`maxmemory`)
- 영속성 설정 권장 (AOF 또는 RDB)
- 정기적인 모니터링 필요

---

**작성일**: 2026-01-26
**분석 기준**: Oracle Cloud Infrastructure
- **OCPU**: 4 코어
- **RAM**: 24GB
- **디스크**: 47GB
